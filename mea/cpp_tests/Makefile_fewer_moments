SRC=$(PWD)/../../src
OBJ=$(PWD)/obj

CXX=g++ -std=c++11 -Wall -g -O3
INC=${HOME}/gsl/include -I${HOME}/install/HDF5/1.10.6/include
LIB=${HOME}/gsl/lib -L${HOME}/install/HDF5/1.10.6/lib

CXXFLAGS=-L$(LIB) -lm -lgsl -lgslcblas -larmadillo -lfftw3 -lhdf5 -lhdf5_hl -lhdf5_cpp #-lgtest -lgmock -lpthread

PROG=CPP-TESTS

all: $(PROG)

$(PROG): $(OBJ)/file_utils.o $(OBJ)/green_utils.o $(OBJ)/integral_utils.o $(OBJ)/IPT2nd3rdorderSingle2.o $(OBJ)/cubic_spline.o
	$(CXX) $(OBJ)/file_utils.o $(OBJ)/green_utils.o $(OBJ)/integral_utils.o $(OBJ)/IPT2nd3rdorderSingle2.o $(OBJ)/cubic_spline.o $(CXXFLAGS) -o spl_fm.out

$(OBJ)/file_utils.o: $(SRC)/file_utils.cpp
	$(CXX) -c -I$(INC) $(SRC)/file_utils.cpp -o $(OBJ)/file_utils.o

$(OBJ)/green_utils.o: $(SRC)/green_utils.cpp
	$(CXX) -c -I$(INC) $(SRC)/green_utils.cpp -o $(OBJ)/green_utils.o

$(OBJ)/IPT2nd3rdorderSingle2.o: $(SRC)/IPT2nd3rdorderSingle2.cpp
	$(CXX) -c -I$(INC) $(SRC)/IPT2nd3rdorderSingle2.cpp -o $(OBJ)/IPT2nd3rdorderSingle2.o

$(OBJ)/cubic_spline.o: $(PWD)/cubic_spline_GG_q_fewer_moments.cpp
	$(CXX) -c -I$(INC) $(PWD)/cubic_spline_GG_q_fewer_moments.cpp -o $(OBJ)/cubic_spline.o

$(OBJ)/integral_utils.o: $(SRC)/integral_utils.cpp
	$(CXX) -c -I$(INC) $(SRC)/integral_utils.cpp -o $(OBJ)/integral_utils.o

clean:
	rm -f $(OBJ)/* $(PWD)/spl_fm.out
